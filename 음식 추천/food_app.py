import streamlit as st
import pandas as pd
import random

def load_food_data():
    """ìŒì‹ ë°ì´í„°ë¥¼ ë¡œë“œí•©ë‹ˆë‹¤."""
    food_data = {}
    try:
        with open('ìŒì‹ ëª©ë¡.txt', 'r', encoding='utf-8') as file:
            lines = file.readlines()
            
        for line in lines[2:]:  # ì²« ë‘ ì¤„ì€ ê±´ë„ˆë›°ê¸°
            if ':' in line:
                food_name, attributes = line.strip().split(':', 1)
                food_name = food_name.strip()
                attributes = [attr.strip() for attr in attributes.split(',')]
                food_data[food_name] = attributes
                
    except FileNotFoundError:
        # íŒŒì¼ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©
        food_data = {
  "ê¹€ì¹˜ì°Œê°œ": ["ì ì‹¬", "ì €ë…", "ì•„ì¹¨", "êµ­ë¬¼ìˆìŒ", "ë§¤ì›€", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ëœì¥ì°Œê°œ": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ë¶ˆê³ ê¸°": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ì•ˆë§¤ì›€"],
  "ì˜¤ì§•ì–´ë³¶ìŒ": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ê³ ë“±ì–´êµ¬ì´": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸", "ì•ˆë§¤ì›€"],
  "ê°ˆì¹˜ì¡°ë¦¼": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë§¤ì›€", "ì•ˆë§¤ì›€"],
  "ì²­êµ­ì¥": ["ì ì‹¬", "ì•„ì¹¨", "êµ­ë¬¼ìˆìŒ", "ì—¬ëŸ¿ì´", "ì•ˆë§¤ì›€"],
  "ìˆœëŒ€êµ­ë°¥": ["ì•„ì¹¨", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ë¼ì§€êµ­ë°¥": ["ì ì‹¬", "ì•„ì¹¨", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ì†Œë¨¸ë¦¬êµ­ë°¥": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ìœ¡ê°œì¥": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ê°ìíƒ•": ["ì €ë…", "ì•¼ì‹", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "í˜¼ì"],
  "ì„¤ë íƒ•": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "í˜¼ì"],
  "ê³°íƒ•": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ê°ˆë¹„íƒ•": ["ì ì‹¬", "êµ­ë¬¼ìˆìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ì•ˆë§¤ì›€"],
  "ë¼ˆí•´ì¥êµ­": ["ì €ë…", "ì•„ì¹¨", "êµ­ë¬¼ìˆìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "ì¶”ì–´íƒ•": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "í˜¼ì"],
  "ëƒ‰ë©´ (ë¬¼ëƒ‰/ë¹„ëƒ‰)": ["ì ì‹¬", "ê°„ì‹", "êµ­ë¬¼ìˆìŒ", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ì¹¼êµ­ìˆ˜": ["ì ì‹¬", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ì”ì¹˜êµ­ìˆ˜": ["ì ì‹¬", "ê°„ì‹", "êµ­ë¬¼ìˆìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ì•ˆë§¤ì›€", "ë‹¤ì´ì–´íŠ¸"],
  "ë¹„ë¹”êµ­ìˆ˜": ["ì ì‹¬", "ê°„ì‹", "êµ­ë¬¼ì—†ìŒ", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë§¤ì›€", "ì•ˆë§¤ì›€"],
  "ìš°ë™": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "í˜¼ì", "ê°„ì‹"],
  "ë¼ë©´": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "ê°„ì‹", "ì•¼ì‹", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë§¤ì›€", "ì•ˆë§¤ì›€", "êµ­ë¬¼ìˆìŒ"],
  "ì«„ë©´": ["ì ì‹¬", "ê°„ì‹", "í˜¼ì", "ë§¤ì›€", "êµ­ë¬¼ì—†ìŒ"],
  "ì§¬ë½•": ["ì ì‹¬", "ì•¼ì‹", "ë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "êµ­ë¬¼ìˆìŒ"],
  "ì§œì¥ë©´": ["ì ì‹¬", "ì•¼ì‹", "ê°„ì‹", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "êµ­ë¬¼ì—†ìŒ"],
  "ë§‰êµ­ìˆ˜": ["ì ì‹¬", "ê°„ì‹", "ë§¤ì›€", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "êµ­ë¬¼ì—†ìŒ"],
  "ì‚¼ê²¹ì‚´": ["ì €ë…", "íšŒì‹", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "ì†Œë¶ˆê³ ê¸°": ["ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì—¬ëŸ¿ì´", "ì•ˆë§¤ì›€", "í˜¼ì"],
  "ë¼ì§€ë¶ˆë°±": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ë‹­ê°ˆë¹„": ["ì €ë…", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ë§¤ì›€", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "LAê°ˆë¹„": ["ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "íšŒì‹"],
  "ë‹­í•œë§ˆë¦¬": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì—¬ëŸ¿ì´", "ì•ˆë§¤ì›€"],
  "ì˜¤ë¦¬ë¶ˆê³ ê¸°": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ì œìœ¡ë³¶ìŒ": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ë‚™ì§€ë³¶ìŒ": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "ë‘ë£¨ì¹˜ê¸°": ["ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ë‹­ë³¶ìŒíƒ•": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ê¹€ì¹˜ë³¶ìŒë°¥": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ë‹¤ì´ì–´íŠ¸"],
  "ì°¸ì¹˜ê¹€ì¹˜ë³¶ìŒ": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ë‹¤ì´ì–´íŠ¸"],
  "ê°€ì§€ë³¶ìŒ": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ê³ ì¶”ì¥ë¶ˆê³ ê¸°": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "ì½”ë‹¤ë¦¬ì°œ": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "ë–¡ë³¶ì´": ["ì ì‹¬", "ì•¼ì‹", "ê°„ì‹", "êµ­ë¬¼ì—†ìŒ", "êµ­ë¬¼ìˆìŒ", "ë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ê¹€ë°¥": ["ì•„ì¹¨", "ì ì‹¬", "ê°„ì‹", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ë‹¤ì´ì–´íŠ¸"],
  "ë¼ë³¶ì´": ["ì ì‹¬", "ê°„ì‹", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ì˜¤ë¯€ë¼ì´ìŠ¤": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì"],
  "ë³¶ìŒìš°ë™": ["ì ì‹¬", "ì•¼ì‹", "ê°„ì‹", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ëˆê¹ŒìŠ¤": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ë°ì´íŠ¸"],
  "ì¥ì–´ë®ë°¥": ["ì €ë…", "ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ìƒì„ ê¹ŒìŠ¤": ["ì ì‹¬", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "íšŒë®ë°¥": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "í•´ë¬¼íƒ•": ["ì €ë…", "êµ­ë¬¼ìˆìŒ", "íšŒì‹", "ë§¤ì›€", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ì•Œíƒ•": ["ì €ë…", "êµ­ë¬¼ìˆìŒ", "ë§¤ì›€", "ì—¬ëŸ¿ì´", "ì•¼ì‹"],
  "ë§¤ìš´íƒ•": ["ì €ë…", "íšŒì‹", "êµ­ë¬¼ìˆìŒ", "ë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ì•„êµ¬ì°œ": ["ì ì‹¬", "ì €ë…", "íšŒì‹", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ë‚™ì§€ì—°í¬íƒ•": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì‡ìŒ", "ì•ˆë§¤ì›€", "íšŒì‹", "ì—¬ëŸ¿ì´"],
  "ë¶€ëŒ€ì°Œê°œ": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ìƒ¤ë¸Œìƒ¤ë¸Œ": ["ì ì‹¬", "ì €ë…", "íšŒì‹", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸", "ë°ì´íŠ¸"],
  "ì´ˆë°¥ì •ì‹": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë°ì´íŠ¸"],
  "í•¨ë°•ìŠ¤í…Œì´í¬": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "íŒŒìŠ¤íƒ€": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ë°ì´íŠ¸"],
  "í”¼ì": ["ì ì‹¬", "ê°„ì‹", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "í–„ë²„ê±°": ["ì•„ì¹¨", "ì ì‹¬", "ê°„ì‹", "ì €ë…", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´"],
  "ì¹˜í‚¨": ["ì €ë…", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´"],
  "ì–‘ê¼¬ì¹˜": ["ì €ë…", "íšŒì‹", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ë°ì´íŠ¸"],
  "ë§ˆë¼íƒ•": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•¼ì‹", "ë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë°ì´íŠ¸"],
  "ì½©ë‚˜ë¬¼êµ­ë°¥": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "ì•¼ì‹", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ë²„ì„¯ì „ê³¨": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ë¹„ì§€ì°Œê°œ": ["ì•„ì¹¨", "ì ì‹¬", "êµ­ë¬¼ìˆìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ë¹„ë¹”ë°¥": ["ì ì‹¬", "ì•„ì¹¨", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ì±„ì†ŒìŒˆë°¥": ["ì ì‹¬", "ì•„ì¹¨", "êµ­ë¬¼ì—†ìŒ", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ë‘ë¶€ì¡°ë¦¼": ["ì ì‹¬", "ì €ë…", "êµ­ë¬¼ìˆìŒ", "ë§¤ì›€", "ì•ˆë§¤ì›€", "í˜¼ì", "ì—¬ëŸ¿ì´", "ë‹¤ì´ì–´íŠ¸"],
  "ìƒëŸ¬ë“œ": ["ì•„ì¹¨", "ì ì‹¬", "ê°„ì‹", "êµ­ë¬¼ì—†ìŒ", "í˜¼ì", "ì•ˆë§¤ì›€", "ë‹¤ì´ì–´íŠ¸"],
  "ì¡±ë°œ": ["ì €ë…", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ì—¬ëŸ¿ì´", "í˜¼ì", "ì•ˆë§¤ì›€"],
  "ë¶ˆì¡±ë°œ": ["ì €ë…", "ì•¼ì‹", "êµ­ë¬¼ì—†ìŒ", "ì—¬ëŸ¿ì´", "í˜¼ì", "ë§¤ì›€"]
}
        
        
    return food_data

def find_matching_foods(food_data, selected_attrs):
    """ì„ íƒëœ ì†ì„±ê³¼ ì¼ì¹˜í•˜ëŠ” ìŒì‹ë“¤ì„ ì°¾ìŠµë‹ˆë‹¤."""
    matching_foods = []
    
    for food_name, food_attrs in food_data.items():
        # ì„ íƒëœ ì†ì„± ì¤‘ í•˜ë‚˜ë¼ë„ ìŒì‹ì˜ ì†ì„±ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ë§¤ì¹­
        if any(attr in food_attrs for attr in selected_attrs):
            # ë§¤ì¹­ ì ìˆ˜ ê³„ì‚° (ì¼ì¹˜í•˜ëŠ” ì†ì„± ìˆ˜)
            match_score = sum(1 for attr in selected_attrs if attr in food_attrs)
            matching_foods.append({
                'ìŒì‹ëª…': food_name,
                'ë§¤ì¹­ì ìˆ˜': match_score,
                'ì´ì ìˆ˜': len(selected_attrs),
                'ì¼ì¹˜ìœ¨': round(match_score / len(selected_attrs) * 100, 1),
                'ì†ì„±': ', '.join(food_attrs)
            })
    
    # ë§¤ì¹­ ì ìˆ˜ë¡œ ì •ë ¬ (ë†’ì€ ìˆœ)
    matching_foods.sort(key=lambda x: x['ë§¤ì¹­ì ìˆ˜'], reverse=True)
    return matching_foods

def main():
    st.set_page_config(
        page_title="ğŸ½ï¸ ìŒì‹ ì¶”ì²œ ì‹œìŠ¤í…œ",
        page_icon="ğŸ½ï¸",
        layout="wide"
    )
    
    # ì œëª©
    st.title("ğŸ½ï¸ ìŒì‹ ì¶”ì²œ ì‹œìŠ¤í…œ")
    st.markdown("ì›í•˜ëŠ” ì†ì„±ì„ ì„ íƒí•˜ë©´ ê·¸ì— ë§ëŠ” ìŒì‹ì„ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤!")
    
    # ìŒì‹ ë°ì´í„° ë¡œë“œ
    food_data = load_food_data()
    
    # ì‚¬ì´ë“œë°”ì— ì†ì„± ì„ íƒ
    st.sidebar.header("ğŸ“‹ ì›í•˜ëŠ” ì†ì„±ì„ ì„ íƒí•˜ì„¸ìš”")
    
    # ì†ì„±ë“¤ì„ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë¶„ë¥˜
    meal_categories = {
        "ğŸ½ï¸ ì‹ì‚¬ ì‹œê°„": ["ì•„ì¹¨", "ì ì‹¬", "ì €ë…", "ê°„ì‹", "ì•¼ì‹"],
        "ğŸ‘¥ ìƒí™©": ["í˜¼ì", "ì—¬ëŸ¿ì´", "íšŒì‹"],
        "ğŸŒ¶ï¸ ë§›": ["ë§¤ì›€", "ì•ˆë§¤ì›€"],
        "ğŸ² êµ­ë¬¼": ["êµ­ë¬¼ìˆìŒ", "êµ­ë¬¼ì—†ìŒ"],
        "ğŸ’ª ê¸°íƒ€": ["ë‹¤ì´ì–´íŠ¸","ë°ì´íŠ¸","ì§‘", "íšŒì‚¬", "ì™¸ì‹", "ë°°ë‹¬", "ì•¼ì™¸"]
    }
    
    selected_attributes = []
    
    for category, attrs in meal_categories.items():
        st.sidebar.subheader(category)
        for attr in attrs:
            if st.sidebar.checkbox(attr, key=attr):
                selected_attributes.append(attr)
    
    # ë©”ì¸ ì»¨í…ì¸ 
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.header("ğŸ¯ ì¶”ì²œ ê²°ê³¼")
        
        if not selected_attributes:
            st.info("ğŸ‘ˆ ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ ì›í•˜ëŠ” ì†ì„±ì„ ì„ íƒí•´ì£¼ì„¸ìš”!(ì¤‘ë³µê°€ëŠ¥!)")
            
            # ëœë¤ ì¶”ì²œ ë²„íŠ¼
            if st.button("ğŸ² ëœë¤ ì¶”ì²œ ë°›ê¸°"):
                food_name = random.choice(list(food_data.keys()))
                food_attrs = food_data[food_name]
                
                st.success(f"ğŸ² ëœë¤ ì¶”ì²œ ê²°ê³¼")
                st.write(f"**ì¶”ì²œ ìŒì‹:** {food_name}")
                st.write(f"**ì†ì„±:** {', '.join(food_attrs)}")
                st.balloons()
        else:
            st.write(f"**ì„ íƒí•˜ì‹  ì†ì„±:** {', '.join(selected_attributes)}")
            
            matching_foods = find_matching_foods(food_data, selected_attributes)
            
            if not matching_foods:
                st.warning("ì„ íƒí•˜ì‹  ì†ì„±ê³¼ ì¼ì¹˜í•˜ëŠ” ìŒì‹ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì†ì„±ì„ ì„ íƒí•´ë³´ì„¸ìš”!")
            else:
                st.success(f"ì´ {len(matching_foods)}ê°œì˜ ìŒì‹ì´ ì¶”ì²œë©ë‹ˆë‹¤!")
                
                # ìƒìœ„ 10ê°œ ìŒì‹ì„ í‘œ í˜•íƒœë¡œ í‘œì‹œ
                df = pd.DataFrame(matching_foods[:10])
                
                # ì ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ ì ìš©
                def color_score(val):
                    if val >= 80:
                        return 'background-color: #90EE90'  # ì—°í•œ ì´ˆë¡
                    elif val >= 60:
                        return 'background-color: #FFE4B5'  # ì—°í•œ ì£¼í™©
                    else:
                        return 'background-color: #FFB6C1'  # ì—°í•œ ë¹¨ê°•
                
                styled_df = df.style.applymap(color_score, subset=['ì¼ì¹˜ìœ¨'])
                st.dataframe(styled_df, use_container_width=True)
                
                if len(matching_foods) > 10:
                    st.info(f"... ì™¸ {len(matching_foods) - 10}ê°œ ë” ìˆìŠµë‹ˆë‹¤.")
    
    with col2:
        st.header("ğŸ“Š í†µê³„")
        
        if selected_attributes:
            matching_foods = find_matching_foods(food_data, selected_attributes)
            
            if matching_foods:
                # í†µê³„ ì •ë³´
                st.metric("ì¶”ì²œ ìŒì‹ ìˆ˜", len(matching_foods))
                
                if matching_foods:
                    avg_score = sum(food['ì¼ì¹˜ìœ¨'] for food in matching_foods) / len(matching_foods)
                    st.metric("í‰ê·  ì¼ì¹˜ìœ¨", f"{avg_score:.1f}%")
                    
                    max_score = max(food['ì¼ì¹˜ìœ¨'] for food in matching_foods)
                    st.metric("ìµœê³  ì¼ì¹˜ìœ¨", f"{max_score}%")
                
                # ì¼ì¹˜ìœ¨ ë¶„í¬
                st.subheader("ì¼ì¹˜ìœ¨ ë¶„í¬")
                score_ranges = {
                    "90% ì´ìƒ": len([f for f in matching_foods if f['ì¼ì¹˜ìœ¨'] >= 90]),
                    "70-89%": len([f for f in matching_foods if 70 <= f['ì¼ì¹˜ìœ¨'] < 90]),
                    "50-69%": len([f for f in matching_foods if 50 <= f['ì¼ì¹˜ìœ¨'] < 70]),
                    "50% ë¯¸ë§Œ": len([f for f in matching_foods if f['ì¼ì¹˜ìœ¨'] < 50])
                }
                
                for range_name, count in score_ranges.items():
                    if count > 0:
                        st.write(f"{range_name}: {count}ê°œ")
    
    # í•˜ë‹¨ì— ì¶”ê°€ ì •ë³´
    st.markdown("---")
    st.markdown("### ğŸ’¡ ì‚¬ìš© íŒ")
    st.markdown("""
    - **ë” ì •í™•í•œ ì¶”ì²œì„ ìœ„í•´**: ì—¬ëŸ¬ ì†ì„±ì„ ì„ íƒí•˜ë©´ ë” ë§ì¶¤í˜• ì¶”ì²œì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤
    - **ì¼ì¹˜ìœ¨**: ì„ íƒí•œ ì†ì„± ì¤‘ ëª‡ %ê°€ í•´ë‹¹ ìŒì‹ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤
    - **ëœë¤ ì¶”ì²œ**: ê³ ë¯¼í•  ì‹œê°„ì´ ì—†ë‹¤ë©´ ëœë¤ ì¶”ì²œì„ ì‚¬ìš©í•´ë³´ì„¸ìš”!
    """)
    
    # ìŒì‹ ë°ì´í„° ì •ë³´
    with st.expander("ğŸ“‹ ì „ì²´ ìŒì‹ ëª©ë¡ ë³´ê¸°"):
        food_df = pd.DataFrame([
            {'ìŒì‹ëª…': name, 'ì†ì„±': ', '.join(attrs)} 
            for name, attrs in food_data.items()
        ])
        st.dataframe(food_df, use_container_width=True)

if __name__ == "__main__":
    main()
